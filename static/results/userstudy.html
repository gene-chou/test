<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Study -- Comparing Quality of Synthesized Videos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .comparison-container {
            margin-bottom: 40px;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
        }
        .media-section {
            margin-bottom: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .image-grid {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: nowrap;
        }
        .image-container {
            width: 200px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-shrink: 0;
        }
        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
        }
        .connection-lines {
            height: 40px;
            position: relative;
            margin: 10px 0;
        }
        .connection-lines::after {
            content: 'â†“';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #666;
        }
        .video-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            justify-content: center;
        }
        .video-container {
            text-align: center;
        }
        /* .video-container video {
            width: 300px;
            height: auto;
            margin-bottom: 10px;
        } */
         /* Add new styles for video transitions */
         .video-container video {
            width: 300px;
            height: auto;
            margin-bottom: 10px;
            border: 4px solid transparent;
            transition: border-color 0.3s ease;
        }

        .video-container video.highlight-start {
            border-color: greenyellow;
        }

        .video-container video.highlight-end {
            border-color: red;
        }

        .video-container video.paused {
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        .voting-form {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
        }
        .voting-category {
            margin-bottom: 30px;
        }
        .voting-instructions {
        margin: 20px 0;
        color: #666;
        font-size: 1.05em;
        text-align: center;
    }
        .category-header {
            margin-bottom: 15px;
        }
        .category-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .category-description {
            font-size: 0.9em;
            color: #666;
            line-height: 1.4;
        }
        .checkbox-group {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 10px;
        }
        .checkbox-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .checkbox-option input[type="radio"] {
            margin: 0;
            width: 18px;
            height: 18px;
        }
        .model-label {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .submit-votes {
            display: block;
            margin: 20px auto 0;
            padding: 12px 24px;
            background: #2196F3;
            color: white;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .submit-votes:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .completion-message {
            text-align: center;
            color: #4CAF50;
            margin-top: 20px;
            display: none;
        }
        .header-section {
            margin-bottom: 30px;
            text-align: center;
        }
        .header-description {
            font-size: 1.1em;
            color: #666;
            margin-top: 10px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.4;
        }
        .tutorial-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #e9ecef;
        }
        .tutorial-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 15px;
            font-weight: bold;
        }
        .tutorial-steps {
            list-style-type: decimal;
            padding-left: 25px;
        }
        .tutorial-steps li {
            margin-bottom: 10px;
            font-size: 1.1em;
            line-height: 1.5;
        }
        .example-section {
            background-color: white;
            border: 1px dashed #ccc;
            padding: 15px;
            margin: 20px 0;
            border-radius: 6px;
        }
        .example-label {
            color: #2196F3;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        .example-grid {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            justify-content: flex-start;
        }
        .example-image {
            width: 150px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
        }
        /* .example-video {
            width: 200px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
        } */
        .example-video video {
            width: 100%;
            height: auto;
            max-height: 384px;
        }
        .example-voting {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
        }
        .highlight-box {
            border: 2px solid #2196F3;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
        }
        .email-section {
            margin-top: 40px;
            padding: 20px;
            background-color: #f5f5f5;
            border-radius: 8px;
            text-align: center;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .email-input {
            width: 300px;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        .email-submit {
            padding: 10px 20px;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }

        .email-submit:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .video-placeholder {
            position: relative;
            width: 300px;
            height: 200px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 4px;
        }

        .play-overlay {
            position: absolute;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 14px;
        }

        .video-placeholder:hover .play-overlay {
            background: rgba(0, 0, 0, 0.8);
        }
    </style>
</head>
<body>
    <div class="header-section">
        <h1>User Study -- Comparing Quality of Synthesized Videos</h1>
        <p class="header-description" style="text-align: left;">
            We thank all users for helping with this study. All votes submitted are recorded, even if the study is not completed entirely.
            No need to overthink the options! If one scene feels too difficult to evaluate, just skip it!
            If you submit at least 10 votes and provide your email address at the bottom, you will be entered into a raffle for the chance to win 1 of 5 $10 Amazon gift cards.
        </p>
    </div>

    <div class="tutorial-section">
        <h2 class="tutorial-title">Tutorial</h2>
        <ol class="tutorial-steps">
            <li>
                <strong>Background</strong>:
                This study compares several models that generate a video sequence based on a few unposed source images of the same scene.
                We expect each model to analyze the scene's structure and simulate a camera movement linking all source images,
                progressing smoothly from source image 1 to source image n. Ideally, the frames generated should remain consistent in terms of content and lighting,
                despite possible variations in the original images. Imagine observing the scene in real life: which video would feel closest to that real experience?
                <!-- <br><strong>Evaluation Criteria</strong>: We ask you to rank the videos based on three criteria: Consistency, CameraPath, and Aesthetics.  -->
            </li>

            <li>
                For each scene, you will see a set of source images at the top.
                <div class="example-section">
                    <div class="example-label">Example: Source Images</div>
                    <div class="example-grid">
                        <div class="example-image">
                            <img src="pt/all_sparse_views/reichstag/views_5_0/images/35221995_8835396469.jpg" alt="Example source image 1" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px;">Source Image 1</div>
                        </div>
                        <div class="example-image">
                            <img src="pt/all_sparse_views/reichstag/views_5_0/images/49051226_8836027266.jpg" alt="Example source image 2" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px;">Source Image 2</div>
                        </div>
                        <div class="example-image">
                            <img src="pt/all_sparse_views/reichstag/views_5_0/images/49284352_2431392889.jpg" alt="Example source image 3" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px;">Source Image 3</div>
                        </div>
                        <div class="example-image">
                            <img src="pt/all_sparse_views/reichstag/views_5_0/images/91549947_3428166276.jpg" alt="Example source image 4" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px;">Source Image 4</div>
                        </div>
                        <div class="example-image">
                            <img src="pt/all_sparse_views/reichstag/views_5_0/images/92342560_2757258130.jpg" alt="Example source image 5" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px;">Source Image 5</div>
                        </div>
                    </div>
                </div>
            </li>
            <li>
                Below the source images, you'll find two videos labeled "Video 1" and "Video 2". Click to play.
                You should be able to observe the video frames transitioning from one source image to the next.
                <div class="example-section">
                    <div class="example-label">Example: Generated Videos</div>
                    <div class="example-grid">
                        <div class="video-row">
                            <div class="video-container">
                                <div class="model-label">Video 1</div>
                                <video playsinline muted>
                                    <source src="pt/luma_generations/reichstag/views_5_0/stitched.mp4" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                            </div>
                            <div class="video-container">
                                <div class="model-label">Video 2</div>
                                <video playsinline muted>
                                    <source src="pt/ours_generations/5/39_0.mp4" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                            </div>
                        </div>
                    </div>
                    <p class="voting-instructions">Note: The green border denotes the first video frame, which should correspond to the first source image. <br>
                        The red border denotes the last video frame, which should correspond to the last source image.<br>
                        The video auto-loops back to green after the last frame.</p>
                </div>
            </li>
            <li>
                For each criterion (Consistency, Camera Path, and Aesthetics), select which video you prefer. We provide detailed descriptions for each criterion -- read carefully before making a decision!
                <div class="example-section">
                    <div class="example-label">Example: Voting Interface</div>
                    <div class="example-voting">
                        <div class="highlight-box">
                            <div style="font-weight: bold; margin-bottom: 5px;">Consistency</div>
                            <div style="color: #666; font-size: 0.9em; margin-bottom: 10px;">
                                Select the video that appears most consistent overall. Which video maintains uniform illumination throughout the scene?
                                If illumination changes noticeably between transitions, the video may lack consistency.
                                Additionally, observe whether objects appear or disappear in ways that seem illogical.
                            </div>
                            <div style="display: flex; gap: 20px;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="example-consistency" value="0">
                                    Video 1
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="example-consistency" value="1">
                                    Video 2
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="example-consistency" value="2">
                                    Cannot Decide
                                </label>
                            </div>
                        </div>
                        <div class="highlight-box">
                            <div style="font-weight: bold; margin-bottom: 5px;">Camera Path</div>
                            <div style="color: #666; font-size: 0.9em; margin-bottom: 10px;">
                                Select the video that most realistically represents a natural movement between the source images.
                                Does the video accurately reflect the layout and structure of the scene as you would expect in real life?
                                If you were physically present, capturing these views, which video best mirrors the path you might take while moving through or around the scene?
                                If the video hallucinates new buildings as it transitions from one source image to the next, it indicates an unrealistic camera path.
                            </div>
                            <div style="display: flex; gap: 20px;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="example-cameraPath" value="0">
                                    Video 1
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="example-cameraPath" value="1">
                                    Video 2
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="example-cameraPath" value="2">
                                    Cannot Decide
                                </label>
                            </div>
                        </div>
                        <div class="highlight-box">
                            <div style="font-weight: bold; margin-bottom: 5px;">Aesthetics</div>
                            <div style="color: #666; font-size: 0.9em; margin-bottom: 10px;">
                                Select the video with higher overall visual quality -- subjective and up to you.
                                Potential considerations could be sharpness of each frame and whether you prefer dynamic objects (e.g. people walking).
                                Consistency and CameraPath can factor into the decision as well.
                            </div>
                            <div style="display: flex; gap: 20px;">
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="example-aesthetics" value="0">
                                    Video 1
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="example-aesthetics" value="1">
                                    Video 2
                                </label>
                                <label style="display: flex; align-items: center; gap: 5px;">
                                    <input type="radio" name="example-aesthetics" value="2">
                                    Cannot Decide
                                </label>
                            </div>
                        </div>
                        <button class="submit-votes" disabled>Submit Votes</button>
                        <div class="completion-message">Thank you! Your votes have been recorded.</div>
                    </div>
                </div>
            </li>
            <!-- <li>Reasoning for selecting votes: <br>
                <strong>Consistency</strong>: Which video maintains a more consistent illumination throughout the scene? 
                If a video tends to change illumination as it transitions from one source image to the next, it may be less consistent.
                Also look for whether whether objects appear or disappear illogically.
                <br>
                <strong>CameraPath</strong>: Does the video capture the layout and structure of the scene accurately? 
                If you were to rotate or zoom in and out of the scene following the source images, which video would you expect to see?
                If the model is hallcinating new buildings as it transitions from one source image to the next, it does not have a realistic camera path.
                <br>
                <strong>Aesthetics</strong>: Don't overthink this criteria as it is subjective. Potential considerations could be sharpness of each frame and whether you prefer dynamic objects (e.g. people walking).
                Consistency and CameraPath can factor into the decision as well.
            </li> -->
            <li>After making all three selections, click the "Submit Votes" button to record your choices. Again, no need to overthink the options! 
                If one criteria feels too difficult to evaluate, just choose "Cannot Decide."
                If one scene feels too difficult to evaluate, just skip it!</li>
        </ol>
        </ol>
    </div>



    <div id="comparisons-container">
        <!-- Comparison containers will be dynamically added here -->
    </div>

    <script>    
        class VideoPool {
            constructor(maxActive = 2) {
                this.maxActive = maxActive;
                this.activeControllers = new Set();
                this.inactiveControllers = new Set();
            }
    
            addController(controller) {
                if (this.activeControllers.size < this.maxActive) {
                    this.activeControllers.add(controller);
                    controller.activate();
                } else {
                    this.inactiveControllers.add(controller);
                    controller.deactivate();
                }
            }
    
            removeController(controller) {
                this.activeControllers.delete(controller);
                this.inactiveControllers.delete(controller);
                controller.cleanup();
                
                // Activate next controller if there's room
                if (this.activeControllers.size < this.maxActive && this.inactiveControllers.size > 0) {
                    const nextController = this.inactiveControllers.values().next().value;
                    this.inactiveControllers.delete(nextController);
                    this.activeControllers.add(nextController);
                    nextController.activate();
                }
            }
    
            prioritizeController(controller) {
                if (this.inactiveControllers.has(controller)) {
                    // If we're at max capacity, deactivate the oldest active controller
                    if (this.activeControllers.size >= this.maxActive) {
                        const oldestController = this.activeControllers.values().next().value;
                        this.activeControllers.delete(oldestController);
                        this.inactiveControllers.add(oldestController);
                        oldestController.deactivate();
                    }
                    
                    // Activate the requested controller
                    this.inactiveControllers.delete(controller);
                    this.activeControllers.add(controller);
                    controller.activate();
                }
            }
        }
    
        class VideoController {
            constructor(container, videoData, pool) {
                this.container = container;
                this.videoData = videoData;
                this.pool = pool;
                this.video1 = null;
                this.video2 = null;
                this.isActive = false;
                this.observer = null;
                this.initialized = false;
                this.videosReady = 0;
                this.endedCount = 0;
                this.isWaitingToRestart = false;
                this.endPauseTriggered = false;
                
                this.setupContainer();
                this.setupIntersectionObserver();
            }
    
            setupContainer() {
                // Create placeholder content with poster images
                this.container.innerHTML = `
                    <div class="video-row">
                        <div class="video-container">
                            <div class="model-label">Video 1</div>
                            <div class="video-placeholder" data-index="0">
                                <div class="play-overlay">Click to load video</div>
                            </div>
                        </div>
                        <div class="video-container">
                            <div class="model-label">Video 2</div>
                            <div class="video-placeholder" data-index="1">
                                <div class="play-overlay">Click to load video</div>
                            </div>
                        </div>
                    </div>
                `;
    
                // Add click handlers for placeholders
                this.container.querySelectorAll('.video-placeholder').forEach((placeholder, index) => {
                    placeholder.addEventListener('click', () => this.initializeVideo());
                });
            }
    
            setupIntersectionObserver() {
                this.observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            this.pool.prioritizeController(this);
                        } else if (this.isActive) {
                            this.pool.removeController(this);
                        }
                    });
                }, {
                    threshold: 0.5
                });
    
                this.observer.observe(this.container);
            }
    
            initializeVideo() {
                if (this.initialized) return;
                
                // Replace placeholders with actual video elements
                const videoRow = this.container.querySelector('.video-row');
                videoRow.innerHTML = `
                    <div class="video-container">
                        <div class="model-label">Video 1</div>
                        <video playsinline muted>
                            <source src="${this.videoData.videos[0]}" type="video/mp4">
                        </video>
                    </div>
                    <div class="video-container">
                        <div class="model-label">Video 2</div>
                        <video playsinline muted>
                            <source src="${this.videoData.videos[1]}" type="video/mp4">
                        </video>
                    </div>
                `;
    
                this.video1 = videoRow.querySelectorAll('video')[0];
                this.video2 = videoRow.querySelectorAll('video')[1];
    
                // Setup video event listeners
                [this.video1, this.video2].forEach(video => {
                    video.removeAttribute('loop');
                    video.addEventListener('loadedmetadata', () => this.handleVideoLoaded());
                    video.addEventListener('ended', () => this.handleVideoEnded());
                    video.addEventListener('timeupdate', () => this.checkForEndPause(video));
                });
                
                this.initialized = true;
                this.pool.addController(this);
            }
    
            handleVideoLoaded() {
                this.videosReady++;
                if (this.videosReady === 2) {
                    this.syncVideos();
                    this.setupInitialPause();
                }
            }
    
            syncVideos() {
                if (!this.video1 || !this.video2) return;
                
                const duration1 = this.video1.duration;
                const duration2 = this.video2.duration;
    
                this.video1.playbackRate = 1;
                this.video2.playbackRate = 1;
    
                if (duration1 > duration2) {
                    this.video1.playbackRate = duration1 / duration2;
                } else if (duration2 > duration1) {
                    this.video2.playbackRate = duration2 / duration1;
                }
            }
    
            checkForEndPause(video) {
                const timeRemaining = video.duration - video.currentTime;
                if (timeRemaining <= 0.1 && !this.endPauseTriggered) {
                    this.triggerEndPause();
                }
            }
    
            triggerEndPause() {
                if (this.endPauseTriggered) return;
                this.endPauseTriggered = true;
    
                [this.video1, this.video2].forEach(video => {
                    video.pause();
                    video.classList.add('highlight-end', 'paused');
                });
    
                setTimeout(() => {
                    [this.video1, this.video2].forEach(video => {
                        video.classList.remove('highlight-end', 'paused');
                    });
                    this.restartVideos();
                }, 500);
            }
    
            handleVideoEnded() {
                this.endedCount++;
                if (this.endedCount === 2) {
                    this.endedCount = 0;
                    this.endPauseTriggered = false;
                }
            }
    
            restartVideos() {
                if (this.isWaitingToRestart) return;
                this.isWaitingToRestart = true;
    
                [this.video1, this.video2].forEach(video => {
                    video.currentTime = 0;
                    video.pause();
                    video.classList.add('highlight-start', 'paused');
                });
    
                setTimeout(() => {
                    [this.video1, this.video2].forEach(video => {
                        video.classList.remove('highlight-start', 'paused');
                        video.play();
                    });
                    this.isWaitingToRestart = false;
                    this.endPauseTriggered = false;
                }, 500);
            }
    
            setupInitialPause() {
                [this.video1, this.video2].forEach(video => {
                    video.pause();
                    video.currentTime = 0;
                    video.classList.add('highlight-start', 'paused');
                });
    
                setTimeout(() => {
                    [this.video1, this.video2].forEach(video => {
                        video.classList.remove('highlight-start', 'paused');
                        video.play();
                    });
                }, 500);
            }
    
            activate() {
                if (!this.initialized) return;
                
                this.isActive = true;
                this.syncAndPlayVideos();
            }
    
            deactivate() {
                if (!this.initialized) return;
                
                this.isActive = false;
                if (this.video1) this.video1.pause();
                if (this.video2) this.video2.pause();
                
                // Reset to placeholder state
                this.resetToPlaceholder();
            }

            resetToPlaceholder() {
                // Reset all the state variables
                this.video1 = null;
                this.video2 = null;
                this.initialized = false;
                this.videosReady = 0;
                this.endedCount = 0;
                this.isWaitingToRestart = false;
                this.endPauseTriggered = false;

                // Restore the original placeholder content
                this.container.innerHTML = `
                    <div class="video-row">
                        <div class="video-container">
                            <div class="model-label">Video 1</div>
                            <div class="video-placeholder" data-index="0">
                                <div class="play-overlay">Click to load video</div>
                            </div>
                        </div>
                        <div class="video-container">
                            <div class="model-label">Video 2</div>
                            <div class="video-placeholder" data-index="1">
                                <div class="play-overlay">Click to load video</div>
                            </div>
                        </div>
                    </div>
                `;

                // Reattach click handlers
                this.container.querySelectorAll('.video-placeholder').forEach((placeholder, index) => {
                    placeholder.addEventListener('click', () => this.initializeVideo());
                });
            }

            cleanup() {
                this.deactivate();
                if (this.observer) {
                    this.observer.disconnect();
                }
            }
    
            syncAndPlayVideos() {
                if (!this.video1 || !this.video2) return;
    
                const duration1 = this.video1.duration;
                const duration2 = this.video2.duration;
    
                this.video1.playbackRate = 1;
                this.video2.playbackRate = 1;
    
                if (duration1 > duration2) {
                    this.video1.playbackRate = duration1 / duration2;
                } else if (duration2 > duration1) {
                    this.video2.playbackRate = duration2 / duration1;
                }
    
                this.video1.currentTime = 0;
                this.video2.currentTime = 0;
                
                Promise.all([
                    this.video1.play().catch(e => console.error('Video 1 play failed:', e)),
                    this.video2.play().catch(e => console.error('Video 2 play failed:', e))
                ]);
            }
        }

        // Initialize video management system
        const videoPool = new VideoPool(2);
        const videoControllers = [];

        // =============================================
        // pairing starts here !!!!!!!!!!!!!!!!!

        const comparisons = [
  {
    "id": "scene1",
    "title": "Scene 1",
    "images": [
      "pt/all_sparse_views/sacre_coeur/views_2_2/images/18025503_3440119974.jpg",
      "pt/all_sparse_views/sacre_coeur/views_2_2/images/70860676_2671019430.jpg"
    ],
    "videos": [
      "pt/luma_generations/sacre_coeur/views_2_2/stitched.mp4",
      "pt/ours_generations/2/44_0.mp4"
    ]
  },
  {
    "id": "scene2",
    "title": "Scene 2",
    "images": [
      "re10k/all_sparse_views/0043978734eec081/views_5_0/0043978734eec081_00000000.png",
      "re10k/all_sparse_views/0043978734eec081/views_5_0/0043978734eec081_00000017.png",
      "re10k/all_sparse_views/0043978734eec081/views_5_0/0043978734eec081_00000035.png",
      "re10k/all_sparse_views/0043978734eec081/views_5_0/0043978734eec081_00000052.png",
      "re10k/all_sparse_views/0043978734eec081/views_5_0/0043978734eec081_00000070.png"
    ],
    "videos": [
      "re10k/luma_generations/0043978734eec081/views_5_0/stitched.mp4",
      "re10k/ours_generations/5/18_0.mp4"
    ]
  },
  {
    "id": "scene3",
    "title": "Scene 3",
    "images": [
      "pt/all_sparse_views/temple_nara_japan/views_2_1/images/87319938_8739757321.jpg",
      "pt/all_sparse_views/temple_nara_japan/views_2_1/images/89263705_7055034603.jpg"
    ],
    "videos": [
      "pt/luma_generations/temple_nara_japan/views_2_1/stitched.mp4",
      "pt/ours_generations/2/58_1.mp4"
    ]
  },
  {
    "id": "scene4",
    "title": "Scene 4",
    "images": [
      "re10k/all_sparse_views/01aaf4ebb084dc16/views_5_0/01aaf4ebb084dc16_00000085.png",
      "re10k/all_sparse_views/01aaf4ebb084dc16/views_5_0/01aaf4ebb084dc16_00000125.png",
      "re10k/all_sparse_views/01aaf4ebb084dc16/views_5_0/01aaf4ebb084dc16_00000165.png",
      "re10k/all_sparse_views/01aaf4ebb084dc16/views_5_0/01aaf4ebb084dc16_00000205.png",
      "re10k/all_sparse_views/01aaf4ebb084dc16/views_5_0/01aaf4ebb084dc16_00000245.png"
    ],
    "videos": [
      "re10k/ours_generations/5/135_0.mp4",
      "re10k/luma_generations/01aaf4ebb084dc16/views_5_0/stitched.mp4"
    ]
  },
  {
    "id": "scene5",
    "title": "Scene 5",
    "images": [
      "pt/all_sparse_views/reichstag/views_2_0/images/64271070_4602086309.jpg",
      "pt/all_sparse_views/reichstag/views_2_0/images/77122925_1063274053.jpg"
    ],
    "videos": [
      "pt/ours_generations/2/39_1.mp4",
      "pt/luma_generations/reichstag/views_2_0/stitched.mp4"
    ]
  },
  {
    "id": "scene6",
    "title": "Scene 6",
    "images": [
      "re10k/all_sparse_views/000db54a47bd43fe/views_4_0/000db54a47bd43fe_00000019.png",
      "re10k/all_sparse_views/000db54a47bd43fe/views_4_0/000db54a47bd43fe_00000057.png",
      "re10k/all_sparse_views/000db54a47bd43fe/views_4_0/000db54a47bd43fe_00000095.png",
      "re10k/all_sparse_views/000db54a47bd43fe/views_4_0/000db54a47bd43fe_00000133.png"
    ],
    "videos": [
      "re10k/ours_generations/4/3_0.mp4",
      "re10k/luma_generations/000db54a47bd43fe/views_4_0/stitched.mp4"
    ]
  },
  {
    "id": "scene7",
    "title": "Scene 7",
    "images": [
      "pt/all_sparse_views/notre_dame_front_facade/views_2_2/images/27335203_487553664.jpg",
      "pt/all_sparse_views/notre_dame_front_facade/views_2_2/images/80749661_7180275066.jpg"
    ],
    "videos": [
      "pt/luma_generations/notre_dame_front_facade/views_2_2/stitched.mp4",
      "pt/ours_generations/2/29_1.mp4"
    ]
  },
  {
    "id": "scene8",
    "title": "Scene 8",
    "images": [
      "pt/all_sparse_views/brandenburg_gate/views_3_2/images/24838916_1516097177.jpg",
      "pt/all_sparse_views/brandenburg_gate/views_3_2/images/55255156_8911548609.jpg",
      "pt/all_sparse_views/brandenburg_gate/views_3_2/images/89436585_2728666510.jpg"
    ],
    "videos": [
      "pt/ours_generations/3/2_1.mp4",
      "pt/luma_generations/brandenburg_gate/views_3_2/stitched.mp4"
    ]
  },
  {
    "id": "scene9",
    "title": "Scene 9",
    "images": [
      "re10k/all_sparse_views/01842c6b21e1d679/views_4_0/01842c6b21e1d679_00000041.png",
      "re10k/all_sparse_views/01842c6b21e1d679/views_4_0/01842c6b21e1d679_00000084.png",
      "re10k/all_sparse_views/01842c6b21e1d679/views_4_0/01842c6b21e1d679_00000127.png",
      "re10k/all_sparse_views/01842c6b21e1d679/views_4_0/01842c6b21e1d679_00000170.png"
    ],
    "videos": [
      "re10k/ours_generations/4/108_0.mp4",
      "re10k/vid-only_generations/4/108_0.mp4"
    ]
  },
  {
    "id": "scene10",
    "title": "Scene 10",
    "images": [
      "pt/all_sparse_views/lincoln_memorial_statue/views_3_0/images/03518714_5846844084.jpg",
      "pt/all_sparse_views/lincoln_memorial_statue/views_3_0/images/17235116_3670762328.jpg",
      "pt/all_sparse_views/lincoln_memorial_statue/views_3_0/images/67904520_2282662352.jpg"
    ],
    "videos": [
      "pt/ours_generations/3/18_1.mp4",
      "pt/luma_generations/lincoln_memorial_statue/views_3_0/stitched.mp4"
    ]
  },
  {
    "id": "scene11",
    "title": "Scene 11",
    "images": [
      "pt/all_sparse_views/st_pauls_cathedral/views_2_0/images/50777283_4936535855.jpg",
      "pt/all_sparse_views/st_pauls_cathedral/views_2_0/images/78582770_410620191.jpg"
    ],
    "videos": [
      "pt/luma_generations/st_pauls_cathedral/views_2_0/stitched.mp4",
      "pt/ours_generations/2/48_0.mp4"
    ]
  },
  {
    "id": "scene12",
    "title": "Scene 12",
    "images": [
      "re10k/all_sparse_views/015d8a2a2834d38c/views_5_0/015d8a2a2834d38c_00000044.png",
      "re10k/all_sparse_views/015d8a2a2834d38c/views_5_0/015d8a2a2834d38c_00000088.png",
      "re10k/all_sparse_views/015d8a2a2834d38c/views_5_0/015d8a2a2834d38c_00000132.png",
      "re10k/all_sparse_views/015d8a2a2834d38c/views_5_0/015d8a2a2834d38c_00000176.png",
      "re10k/all_sparse_views/015d8a2a2834d38c/views_5_0/015d8a2a2834d38c_00000220.png"
    ],
    "videos": [
      "re10k/luma_generations/015d8a2a2834d38c/views_5_0/stitched.mp4",
      "re10k/ours_generations/5/99_0.mp4"
    ]
  },
  {
    "id": "scene13",
    "title": "Scene 13",
    "images": [
      "re10k/all_sparse_views/000c3ab189999a83/views_5_0/000c3ab189999a83_00000129.png",
      "re10k/all_sparse_views/000c3ab189999a83/views_5_0/000c3ab189999a83_00000166.png",
      "re10k/all_sparse_views/000c3ab189999a83/views_5_0/000c3ab189999a83_00000203.png",
      "re10k/all_sparse_views/000c3ab189999a83/views_5_0/000c3ab189999a83_00000240.png",
      "re10k/all_sparse_views/000c3ab189999a83/views_5_0/000c3ab189999a83_00000277.png"
    ],
    "videos": [
      "re10k/luma_generations/000c3ab189999a83/views_5_0/stitched.mp4",
      "re10k/ours_generations/5/0_0.mp4"
    ]
  },
  {
    "id": "scene14",
    "title": "Scene 14",
    "images": [
      "re10k/all_sparse_views/01a2277ee817b310/views_3_0/01a2277ee817b310_00000030.png",
      "re10k/all_sparse_views/01a2277ee817b310/views_3_0/01a2277ee817b310_00000065.png",
      "re10k/all_sparse_views/01a2277ee817b310/views_3_0/01a2277ee817b310_00000100.png"
    ],
    "videos": [
      "re10k/vid-only_generations/3/126_0.mp4",
      "re10k/ours_generations/3/126_0.mp4"
    ]
  },
  {
    "id": "scene15",
    "title": "Scene 15",
    "images": [
      "pt/all_sparse_views/brandenburg_gate/views_3_0/images/38050442_8184868664.jpg",
      "pt/all_sparse_views/brandenburg_gate/views_3_0/images/87789955_4151176666.jpg",
      "pt/all_sparse_views/brandenburg_gate/views_3_0/images/89274779_2983340497.jpg"
    ],
    "videos": [
      "pt/ours_generations/3/0_0.mp4",
      "pt/vid-only_generations/3/0_0.mp4"
    ]
  },
  {
    "id": "scene16",
    "title": "Scene 16",
    "images": [
      "pt/all_sparse_views/st_pauls_cathedral/views_3_1/images/23168302_9287800128.jpg",
      "pt/all_sparse_views/st_pauls_cathedral/views_3_1/images/36924691_6406659277.jpg",
      "pt/all_sparse_views/st_pauls_cathedral/views_3_1/images/64684364_2174886426.jpg"
    ],
    "videos": [
      "pt/luma_generations/st_pauls_cathedral/views_3_1/stitched.mp4",
      "pt/ours_generations/3/49_1.mp4"
    ]
  },
  {
    "id": "scene17",
    "title": "Scene 17",
    "images": [
      "pt/all_sparse_views/notre_dame_front_facade/views_4_0/images/22923618_3392895108.jpg",
      "pt/all_sparse_views/notre_dame_front_facade/views_4_0/images/76492687_2293746202.jpg",
      "pt/all_sparse_views/notre_dame_front_facade/views_4_0/images/76692819_8608643093.jpg",
      "pt/all_sparse_views/notre_dame_front_facade/views_4_0/images/99388900_7610461422.jpg"
    ],
    "videos": [
      "pt/ours_generations/4/27_0.mp4",
      "pt/luma_generations/notre_dame_front_facade/views_4_0/stitched.mp4"
    ]
  },
  {
    "id": "scene18",
    "title": "Scene 18",
    "images": [
      "pt/all_sparse_views/pantheon_exterior/views_2_0/images/07184561_9337173062.jpg",
      "pt/all_sparse_views/pantheon_exterior/views_2_0/images/45535681_498276500.jpg"
    ],
    "videos": [
      "pt/ours_generations/2/33_0.mp4",
      "pt/luma_generations/pantheon_exterior/views_2_0/stitched.mp4"
    ]
  },
  {
    "id": "scene19",
    "title": "Scene 19",
    "images": [
      "re10k/all_sparse_views/01b08e2f20321127/views_5_0/01b08e2f20321127_00000000.png",
      "re10k/all_sparse_views/01b08e2f20321127/views_5_0/01b08e2f20321127_00000018.png",
      "re10k/all_sparse_views/01b08e2f20321127/views_5_0/01b08e2f20321127_00000037.png",
      "re10k/all_sparse_views/01b08e2f20321127/views_5_0/01b08e2f20321127_00000055.png",
      "re10k/all_sparse_views/01b08e2f20321127/views_5_0/01b08e2f20321127_00000074.png"
    ],
    "videos": [
      "re10k/ours_generations/5/138_0.mp4",
      "re10k/luma_generations/01b08e2f20321127/views_5_0/stitched.mp4"
    ]
  },
  {
    "id": "scene20",
    "title": "Scene 20",
    "images": [
      "pt/all_sparse_views/sacre_coeur/views_2_1/images/02580991_8300101521.jpg",
      "pt/all_sparse_views/sacre_coeur/views_2_1/images/03654060_2228949569.jpg"
    ],
    "videos": [
      "pt/luma_generations/sacre_coeur/views_2_1/stitched.mp4",
      "pt/ours_generations/2/43_0.mp4"
    ]
  },
  {
    "id": "scene21",
    "title": "Scene 21",
    "images": [
      "pt/all_sparse_views/trevi_fountain/views_3_0/images/29740134_3799463911.jpg",
      "pt/all_sparse_views/trevi_fountain/views_3_0/images/37233881_3650701281.jpg",
      "pt/all_sparse_views/trevi_fountain/views_3_0/images/75017867_5746101695.jpg"
    ],
    "videos": [
      "pt/luma_generations/trevi_fountain/views_3_0/stitched.mp4",
      "pt/ours_generations/3/60_1.mp4"
    ]
  },
  {
    "id": "scene22",
    "title": "Scene 22",
    "images": [
      "pt/all_sparse_views/piazza_san_marco/views_2_1/images/04412498_5871274067.jpg",
      "pt/all_sparse_views/piazza_san_marco/views_2_1/images/87179181_4063549880.jpg"
    ],
    "videos": [
      "pt/luma_generations/piazza_san_marco/views_2_1/stitched.mp4",
      "pt/ours_generations/2/37_0.mp4"
    ]
  },
  {
    "id": "scene23",
    "title": "Scene 23",
    "images": [
      "re10k/all_sparse_views/00beb03ef95dc637/views_3_0/00beb03ef95dc637_00000028.png",
      "re10k/all_sparse_views/00beb03ef95dc637/views_3_0/00beb03ef95dc637_00000065.png",
      "re10k/all_sparse_views/00beb03ef95dc637/views_3_0/00beb03ef95dc637_00000102.png"
    ],
    "videos": [
      "re10k/ours_generations/3/57_0.mp4",
      "re10k/luma_generations/00beb03ef95dc637/views_3_0/stitched.mp4"
    ]
  },
  {
    "id": "scene24",
    "title": "Scene 24",
    "images": [
      "re10k/all_sparse_views/0181d3b41c2cf87c/views_2_0/0181d3b41c2cf87c_00000029.png",
      "re10k/all_sparse_views/0181d3b41c2cf87c/views_2_0/0181d3b41c2cf87c_00000059.png"
    ],
    "videos": [
      "re10k/ours_generations/2/105_0.mp4",
      "re10k/luma_generations/0181d3b41c2cf87c/views_2_0/stitched.mp4"
    ]
  }
];



        // pairing ends here !!!!!!!!!!!!!!!!!
        // =============================================

        const categoryDescriptions = {
            consistency: "Select the video that appears most consistent overall. Which video maintains uniform illumination throughout the scene? If illumination changes noticeably between transitions, the video may lack consistency. Additionally, observe whether objects appear or disappear in ways that seem illogical.",
            cameraPath: "Select the video that most realistically represents a natural movement between the source images. Does the video accurately reflect the layout and structure of the scene as you would expect in real life? If you were physically present, capturing these views, which video best mirrors the path you might take while moving through or around the scene? If the video hallucinates new buildings as it transitions from one source image to the next, it indicates an unrealistic camera path.",
            aesthetics: "Select the video with higher overall visual quality -- subjective and up to you. Potential considerations could be sharpness of each frame and whether you prefer dynamic objects (e.g. people walking). Consistency and CameraPath can factor into the decision as well."
        };

        

        class VotingSystem {
            constructor(comparisonId) {
                this.comparisonId = comparisonId;
                this.votes = {
                    consistency: null,
                    cameraPath: null,
                    aesthetics: null
                };
            }

            handleVote(category, videoIndex) {
                this.votes[category] = videoIndex;
                this.updateUI(category);
                this.checkSubmitButton();
            }

            updateUI(category) {
                const inputs = document.querySelectorAll(`#voting-form-${this.comparisonId} input[name="${category}"]`);
                inputs.forEach(input => {
                    input.checked = parseInt(input.value) === this.votes[category];
                });
            }

            checkSubmitButton() {
                const submitButton = document.querySelector(`#submit-${this.comparisonId}`);
                const isComplete = Object.values(this.votes).every(vote => vote !== null);
                submitButton.disabled = !isComplete;
            }

            async submitVotes() {
                const voteData = {
                    comparisonId: this.comparisonId,
                    votes: this.votes
                };

                try {
                    const response = await fetch('/api/submit_vote', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(voteData)
                    });

                    if (response.ok) {
                        const messageDiv = document.querySelector(`#completion-${this.comparisonId}`);
                        messageDiv.style.display = 'block';

                        const form = document.querySelector(`#voting-form-${this.comparisonId}`);
                        form.querySelectorAll('input').forEach(input => input.disabled = true);
                        form.querySelector('button').disabled = true;
                    } else {
                        alert('Error submitting votes. Please try again.');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Error submitting votes. Please try again.');
                }
            }
        }

        // Create comparison containers and initialize voting systems
        const votingSystems = {};

        comparisons.forEach(comparison => {
        const container = document.createElement('div');
        container.className = 'comparison-container';
        container.innerHTML = `
            <h2>${comparison.title}</h2>
            <div class="media-section">
                <div class="image-grid">
                    ${comparison.images.map((image, index) => `
                        <div class="image-container">
                            <div class="model-label">Source Image ${index + 1}</div>
                            <img src="${image}" alt="Source image ${index + 1}">
                        </div>
                    `).join('')}
                </div>
                <div class="connection-lines"></div>
                <div id="video-section-${comparison.id}" class="video-section"></div>
            </div>
            <p class="voting-instructions">Note: The green border denotes the first video frame, which should correspond to the first source image. <br>
                The red border denotes the last video frame, which should correspond to the last source image.<br>
                The video auto-loops back to green after the last frame.</p>
            <div id="voting-form-${comparison.id}" class="voting-form">
                ${['consistency', 'cameraPath', 'aesthetics'].map(category => `
                    <div class="voting-category">
                        <div class="category-header">
                            <div class="category-title">${category.charAt(0).toUpperCase() + category.slice(1)}</div>
                            <div class="category-description">${categoryDescriptions[category]}</div>
                        </div>
                        <div class="checkbox-group">
                            <label class="checkbox-option">
                                <input type="radio" name="${category}" value="0"
                                    onchange="votingSystems['${comparison.id}'].handleVote('${category}', 0)">
                                Video 1
                            </label>
                            <label class="checkbox-option">
                                <input type="radio" name="${category}" value="1"
                                    onchange="votingSystems['${comparison.id}'].handleVote('${category}', 1)">
                                Video 2
                            </label>
                            <label class="checkbox-option">
                                <input type="radio" name="${category}" value="2"
                                    onchange="votingSystems['${comparison.id}'].handleVote('${category}', 2)">
                                Cannot Decide
                            </label>
                        </div>
                    </div>
                `).join('')}
                <button id="submit-${comparison.id}" class="submit-votes"
                    onclick="votingSystems['${comparison.id}'].submitVotes()" disabled>
                    Submit Votes
                </button>
                <div id="completion-${comparison.id}" class="completion-message">
                    Thank you! Your votes have been recorded.
                </div>
            </div>
        `;

        document.getElementById('comparisons-container').appendChild(container);
        
        // Create a video controller for this comparison
        const videoSection = container.querySelector(`#video-section-${comparison.id}`);
        const controller = new VideoController(videoSection, comparison, videoPool);
        videoControllers.push(controller);
        
        // Initialize voting system
        votingSystems[comparison.id] = new VotingSystem(comparison.id);
    });

    // Initialize tutorial videos
    setTimeout(() => {
        const tutorialSection = document.querySelector('.tutorial-section');
        const videoSection = tutorialSection.querySelector('.video-row').parentElement;
        const tutorialVideoData = {
            videos: [
                "pt/luma_generations/reichstag/views_5_0/stitched.mp4",
                "pt/ours_generations/5/39_0.mp4"
            ]
        };
        const tutorialController = new VideoController(videoSection, tutorialVideoData, videoPool);
        videoControllers.push(tutorialController);
    }, 0);

    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
        videoControllers.forEach(controller => controller.cleanup());
    });

    function handleEmailSubmit(event) {
        event.preventDefault();
        const emailInput = document.getElementById('email-input');
        const emailSubmit = document.getElementById('email-submit');
        const confirmationMessage = document.getElementById('email-confirmation');
        
        emailInput.disabled = true;
        emailSubmit.disabled = true;
        confirmationMessage.style.display = 'block';
        emailInput.style.backgroundColor = '#f5f5f5';
    }
</script>

    <div class="email-section">
        <h2>Enter Raffle</h2>
        <p>Submit your email to enter the raffle for a chance to win an Amazon gift card!</p>
        <form id="email-form" onsubmit="handleEmailSubmit(event)">
            <input
                type="email"
                id="email-input"
                class="email-input"
                placeholder="Enter your email address"
                required
            >
            <button
                type="submit"
                id="email-submit"
                class="email-submit"
            >
                Submit Email
            </button>
        </form>
        <p id="email-confirmation" style="display: none; color: #4CAF50;">
            Thank you! Your email has been recorded for the raffle.
        </p>
    </div>

</body>
</html>